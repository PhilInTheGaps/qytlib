language: cpp
jobs:
  include:
  - os: linux
    compiler: gcc
    dist: bionic
    script:
    - mkdir build
    - cd build
    - cmake .. -G "Unix Makefiles"
    - cd ..
    - build-wrapper-linux-x86-64 --out-dir bw-output cmake --build build/
    - make test
    - sonar-scanner
  - os: linux
    compiler: gcc
    dist: xenial
    script:
    - mkdir build
    - cd build
    - cmake .. -G "Unix Makefiles"
    - make -j$(nproc)
    - make test
  - os: osx
    before_install:
    - brew link qt --force
    script:
    - mkdir build
    - cd build
    - cmake .. -G "Unix Makefiles" -DQt5_DIR=$(brew --prefix qt)/lib/cmake/Qt5
    - make -j$(sysctl -n hw.physicalcpu)
    - make test
addons:
  apt:
    update: true
    packages:
    - qt5-default
    - qtbase5-dev-tools
    - qtdeclarative5-dev
    - libtinyxml2-dev
  homebrew:
    update: true
    packages:
    - qt
    - tinyxml2
  sonarcloud:
    organization: rophil
    token:
        secure: rWnkgiAi09/oqWTnaQfGEn7H3fZKYtUeVNC5kV2iTVsXMaMJqKvMfyDYEwa8oWk657sxaTvvTB7UlARtoDzg0irVOS+l3m+VOiBqGw6o6nAthesMxDewppAQNnLnQZZErX2kfjhaFFkHUr6IDmwci3kr4pZcDqcVcaWvl2iBsZ1E8GYJof2FYhxAWyzMfYYlJdp4Y/TRORIrJV5FczyDcWWjpjjJLWgEh/FYCyoOaYeBTb7V8i2fsyZDQqQiFaUIvb6XKl1/sCafajF2h8gUE5Q3Ccp2HW1S3JFBqEOn3kbbKsPVJwHrrje3vCl9uGVzgw2t9P5l8h0jL9/DxNROhEgr8RoMxTwLUhGvv4lYLI74Or53SZw3THz7TFIoUjKhLM05Uva6p0pgS48n9x9vkaVstknpw47tgJfeNa1/9sIPE28ADjwJlx6hg7+be5P/F54NzJRRnKBRGlJX/sfLNVE+TlztUeatLx/tbP/9XFXWVBwDSBGmF4UQdyxG3Yp5gzb4mGZQZ0eqga3bLHzxKcMAl6r3g8SuRq+8uhvMPhCEDwT+JWfYeMPMiyWnbczWsyWx2Mn63t3ciRycdqSLu3MWutuyN0vF+hAslZPvr1XO9ZxoMD352hqpxcs6pLsH931CbnTiCV0gSjqQYXeDcKGPfgzBSHZAO1iRCCLR5NE=
notifications:
  email:
    recipients:
    - phil.hoffmann@zoho.eu
    on_success: never
    on_failure: always
